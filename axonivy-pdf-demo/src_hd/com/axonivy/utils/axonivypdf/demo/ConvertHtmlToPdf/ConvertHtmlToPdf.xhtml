<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions">
<h:body>
  <ui:composition template="/layouts/frame-10-full-width.xhtml">
    <ui:define name="title">#{ivy.cms.co('/Dialogs/com/axonivy/utils/axonivypdf/demo/ConvertHtmlToPdf/Title')}</ui:define>
    <ui:define name="content">
      <p:dialog modal="true" widgetVar="download-status-dialog"
        header="Status" draggable="false" closable="false"
        resizable="false">
        <i class="pi pi-spinner pi-spin" style="font-size: 3rem"></i>
      </p:dialog>
      <h2>#{ivy.cms.co('/Dialogs/com/axonivy/utils/axonivypdf/demo/ConvertHtmlToPdf/Header')}</h2>
      <h:form id="form" enctype="multipart/form-data">
        <p:fileUpload value="#{pdfFactoryBean.uploadedFile}"
          accept=".html" skinSimple="true" mode="simple"
          allowTypes="/(\.|\/)(html)$/"
          label="#{ivy.cms.co('/Dialogs/com/axonivy/utils/axonivypdf/demo/ConvertHtmlToPdf/ChooseHtmlFile')}" />

        <p:commandButton
          value="#{ivy.cms.co('/Dialogs/com/axonivy/utils/axonivypdf/demo/Common/ConvertAndDownload')}"
          ajax="false"
          actionListener="#{pdfFactoryBean.convertHtmlToPdf}"
          icon="pi pi-download"
          styleClass="mt-3 ui-button-outlined block"
          onclick="PrimeFaces.monitorDownload(startDownload, stopDownload);">
          <p:fileDownload value="#{pdfFactoryBean.fileForDownload}" />
        </p:commandButton>

        <script type="text/javascript">
            function startDownload() {
              var statusDialog = PF('download-status-dialog');
              statusDialog.jq.removeAttr("download-status");
              statusDialog.show();
            }
 
            function stopDownload() {
              var statusDialog = PF('download-status-dialog');
              statusDialog.jq.attr("download-status","completed");
              statusDialog.hide();
            }
        </script>
      </h:form>
    </ui:define>
  </ui:composition>
</h:body>
</html>
